{% extends 'base.html' %}
{% block title %}Manage Users - Admin{% endblock %}

{% block content %}
<div class="view-header">
    <div class="header-title">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="vertical-align: middle; margin-right: 8px;"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
        Manage Users
    </div>
</div>

<div style="padding: 16px;">
    <!-- Admin Table -->
    <div style="background: var(--bg-tertiary); border-radius: 12px; overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 1px solid var(--border-color);">
                    <th style="padding: 12px 16px; text-align: left; color: var(--text-secondary); font-size: 14px;">ID</th>
                    <th style="padding: 12px 16px; text-align: left; color: var(--text-secondary); font-size: 14px;">Username</th>
                    <th style="padding: 12px 16px; text-align: left; color: var(--text-secondary); font-size: 14px;">Email</th>
                    <th style="padding: 12px 16px; text-align: left; color: var(--text-secondary); font-size: 14px;">Role</th>
                    <th style="padding: 12px 16px; text-align: left; color: var(--text-secondary); font-size: 14px;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr style="border-bottom: 1px solid var(--border-color);">
                    <td style="padding: 12px 16px; color: var(--text-secondary); font-size: 14px;">{{ user.id }}</td>
                    <td style="padding: 12px 16px;">
                        <span class="display-name">{{ user.username }}</span>
                    </td>
                    <td style="padding: 12px 16px; color: var(--text-secondary); font-size: 14px;">{{ user.email }}</td>
                    <td style="padding: 12px 16px;">
                        {% if user.role == 'admin' %}
                        <span style="color: var(--accent-blue); font-size: 13px;">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor" style="vertical-align: middle; margin-right: 4px;"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
                            Admin
                        </span>
                        {% else %}
                        <span style="color: var(--text-secondary); font-size: 13px;">User</span>
                        {% endif %}
                    </td>
                    <td style="padding: 12px 16px;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <form method="POST" action="{{ url_for('admin.change_role', user_id=user.id) }}" style="display: inline;">
                                <select name="role" onchange="this.form.submit()" 
                                    style="padding: 6px 10px; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary); font-size: 13px; cursor: pointer;">
                                    <option value="user" {{ 'selected' if user.role == 'user' else '' }}>User</option>
                                    <option value="admin" {{ 'selected' if user.role == 'admin' else '' }}>Admin</option>
                                </select>
                            </form>
                            <form method="POST" action="{{ url_for('admin.delete_user', user_id=user.id) }}" 
                                  onsubmit="return confirm('Are you sure you want to delete this user?');" style="display: inline;">
                                <button type="submit" style="padding: 6px 12px; background: transparent; border: 1px solid #f4212e; border-radius: 6px; color: #f4212e; font-size: 13px; cursor: pointer;">
                                    Delete
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <a href="{{ url_for('admin.admin_dashboard') }}" style="display: inline-block; margin-top: 16px; padding: 10px 20px; border: 1px solid var(--border-color); border-radius: 9999px; color: var(--text-primary); text-decoration: none; font-size: 14px;">
        ‚Üê Back to Dashboard
    </a>
</div>
{% endblock %}
