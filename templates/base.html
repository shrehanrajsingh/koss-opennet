<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Home / OpenNet{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    
    <div class="app-layout">
        <!-- LEFT SIDEBAR -->
        <header class="sidebar-left">
            <a href="{{ url_for('posts.feed') }}" class="nav-logo">
                <svg class="logo-icon" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                </svg>
            </a>
            
            <nav>
                <a href="{{ url_for('posts.feed') }}" class="nav-item active">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                    Home
                </a>
                <a href="{{ url_for('search.search') }}" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    Explore
                </a>
                <a href="{{ url_for('social.notifications') }}" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>
                    Notifications
                </a>
                <a href="{{ url_for('messages.inbox') }}" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                    Messages
                </a>
                {% if current_user %}
                <a href="{{ url_for('profile.view_profile', id=current_user.id) }}" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                    Profile
                </a>
                {% if current_user.role == 'admin' %}
                <a href="{{ url_for('admin.admin_dashboard') }}" class="nav-item" style="color: var(--accent-blue);">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
                    Admin
                </a>
                {% endif %}
                {% endif %}
                <a href="{{ url_for('auth.logout') }}" class="nav-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/></svg>
                    Logout
                </a>
            </nav>
            
            <button class="nav-post-btn">Post</button>
            
            {% if current_user %}
            <div class="nav-user-profile">
                <img src="{{ url_for('upload.serve_upload', filename=current_user.profile_pic) }}" 
                     class="user-avatar-small"
                     onerror="this.onerror=null;this.src='{{ url_for('static', filename='img/default_avatar.png') }}'">
                <div class="user-info-mini">
                    <span class="name">{{ current_user.username }}</span>
                    <span class="handle">@{{ current_user.username }}</span>
                </div>
            </div>
            {% endif %}
        </header>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            {% block content %}{% endblock %}
        </main>

        <!-- RIGHT SIDEBAR -->
        <aside class="sidebar-right">
            <div class="search-bar">
                <form action="{{ url_for('search.search') }}">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                        <input type="text" name="q" class="search-input" placeholder="Search">
                    </div>
                </form>
            </div>
            
            <div class="widget-card">
                <h3 class="widget-title">What's happening</h3>
                <div class="trending-item">
                    <div class="trending-meta">
                        <span>Technology · Trending</span>
                        <span>...</span>
                    </div>
                    <span class="trending-topic">#KOSSOnTop</span>
                    <span class="trending-meta">2.14B posts</span>
                </div>
                <div class="trending-item">
                    <div class="trending-meta">
                        <span>Technology · Trending</span>
                        <span>...</span>
                    </div>
                    <span class="trending-topic">#YearOfLinuxDesktop</span>
                    <span class="trending-meta">54.2K posts</span>
                </div>
                 <div class="trending-item">
                    <div class="trending-meta">
                        <span>Technology · Trending</span>
                        <span>...</span>
                    </div>
                    <span class="trending-topic">#KOSS</span>
                    <span class="trending-meta">22K posts</span>
                </div>
                <a href="#" style="color: var(--accent-blue); font-size: 14px;">Show more</a>
            </div>
            
            <div class="widget-card">
                <h3 class="widget-title">Who to follow</h3>
                <div class="follow-item">
                    <div class="follow-user">
                         <div style="width: 40px; height: 40px; background: #333; border-radius: 50%;"></div>
                        <div>
                            <span style="font-weight: bold; display: block;">The Island Diaries</span>
                            <span style="color: grey; font-size: 14px;">@island_diaries</span>
                        </div>
                    </div>
                    <button class="follow-btn">Follow</button>
                </div>
                <div class="follow-item">
                    <div class="follow-user">
                         <div style="width: 40px; height: 40px; background: #333; border-radius: 50%;"></div>
                        <div>
                            <span style="font-weight: bold; display: block;">yAI</span>
                            <span style="color: grey; font-size: 14px;">@y_ai</span>
                        </div>
                    </div>
                    <button class="follow-btn">Follow</button>
                </div>
                <a href="#" style="color: var(--accent-blue); font-size: 14px;">Show more</a>
            </div>
        </aside>
    </div>

    <!-- MOBILE BOTTOM NAVIGATION -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <a href="{{ url_for('posts.feed') }}" class="mobile-nav-item active">
                <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                <span>Home</span>
            </a>
            <a href="{{ url_for('search.search') }}" class="mobile-nav-item">
                <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                <span>Search</span>
            </a>
            <a href="{{ url_for('social.notifications') }}" class="mobile-nav-item">
                <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>
                <span>Alerts</span>
            </a>
            <a href="{{ url_for('messages.inbox') }}" class="mobile-nav-item">
                <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                <span>DMs</span>
            </a>
            {% if current_user %}
            <a href="{{ url_for('profile.view_profile', id=current_user.id) }}" class="mobile-nav-item">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                <span>Profile</span>
            </a>
            {% else %}
            <a href="{{ url_for('auth.login') }}" class="mobile-nav-item">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                <span>Login</span>
            </a>
            {% endif %}
        </div>
    </nav>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
