{% extends 'base.html' %}
{% block title %}Search - OpenNet{% endblock %}

{% block content %}
<div class="view-header">
    <div class="header-title">Search</div>
</div>

<div style="padding: 16px;">
    <form method="GET" action="{{ url_for('search.search') }}">
        <div class="search-input-wrapper" style="margin-bottom: 16px;">
            <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
            <input type="text" name="q" value="{{ query }}" class="search-input" placeholder="Search users and posts..." style="flex: 1;">
            <button type="submit" class="mini-post-btn">Search</button>
        </div>
    </form>
    
    {% if query %}
    <div class="search-results">
        <h2 style="color: var(--text-primary); margin-bottom: 16px; font-size: 18px;">Results for: <span style="color: var(--accent-blue);">{{ query|safe }}</span></h2>
        
        <div class="results-section" style="margin-bottom: 24px;">
            <h3 style="color: var(--text-secondary); font-size: 14px; margin-bottom: 12px;"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="vertical-align: middle; margin-right: 4px;"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg> Users ({{ users|length }})</h3>
            {% for user in users %}
            <div class="post" style="padding: 12px 16px;">
                <img src="{{ url_for('upload.serve_upload', filename=user.profile_pic) }}" 
                     class="create-avatar"
                     onerror="this.onerror=null;this.src='{{ url_for('static', filename='img/default_avatar.png') }}'">
                <div class="post-content">
                    <a href="{{ url_for('profile.view_profile', id=user.id) }}" style="text-decoration: none;">
                        <span class="display-name">{{ user.username }}</span>
                        <span class="username">@{{ user.username }}</span>
                    </a>
                    <p style="color: var(--text-secondary); margin-top: 4px;">{{ user.bio|safe }}</p>
                </div>
            </div>
            {% else %}
            <p style="color: var(--text-secondary); padding: 16px;">No users found.</p>
            {% endfor %}
        </div>
        
        <div class="results-section">
            <h3 style="color: var(--text-secondary); font-size: 14px; margin-bottom: 12px;"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="vertical-align: middle; margin-right: 4px;"><path d="M14 17H4v2h10v-2zm6-8H4v2h16V9zM4 15h16v-2H4v2zM4 5v2h16V5H4z"/></svg> Posts ({{ posts|length }})</h3>
            {% for post in posts %}
            <div class="post" style="padding: 12px 16px;">
                <div class="post-content" style="margin-left: 0;">
                    <div class="user-meta" style="margin-bottom: 4px;">
                        <span class="display-name">{{ post.username }}</span>
                    </div>
                    <p class="post-text" style="font-size: 15px; margin-bottom: 0;">{{ post.content|safe }}</p>
                </div>
            </div>
            {% else %}
            <p style="color: var(--text-secondary); padding: 16px;">No posts found.</p>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
